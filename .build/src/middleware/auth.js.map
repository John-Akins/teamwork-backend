{"version":3,"sources":["../../../src/middleware/auth.js"],"names":["auth","allUsers","req","res","next","token","headers","authorization","split","decodedToken","jwt","verify","userId","body","e","status","json","error","adminOnly","isAdmin","console","log"],"mappings":";;;;;;;;;AAAA;;AAEA,IAAMA,IAAI,GAAG,EAAb;;AAEAA,IAAI,CAACC,QAAL,GAAgB,UAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AACnC,MAAG;AACF,QAAMC,KAAK,GAAGH,GAAG,CAACI,OAAJ,CAAYC,aAAZ,CAA0BC,KAA1B,CAAgC,GAAhC,EAAqC,CAArC,CAAd;;AACA,QAAMC,YAAY,GAAGC,yBAAIC,MAAJ,CAAWN,KAAX,EAAkB,+DAAlB,CAArB;;AACA,QAAG;AAAA,UACMO,MADN,GACiBH,YADjB,CACMG,MADN;;AAEF,UAAIV,GAAG,CAACW,IAAJ,CAASD,MAAT,IAAmBV,GAAG,CAACW,IAAJ,CAASD,MAAT,KAAoBA,MAA3C,EACA;AACC,cAAM,iBAAN;AACA,OAHD,MAKA;AACCR,QAAAA,IAAI;AACJ;AACD,KAVD,CAWA,OAAMU,CAAN,EAAS;AACRX,MAAAA,GAAG,CAACY,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AACpBC,QAAAA,KAAK,EAAEH;AADa,OAArB;AAGA;AACD,GAnBD,CAoBA,OAAMA,CAAN,EAAS;AACRX,IAAAA,GAAG,CAACY,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AACpBC,MAAAA,KAAK,EAAE,yBAAyBH;AADZ,KAArB;AAGA;AACD,CA1BD;;AA4BAd,IAAI,CAACkB,SAAL,GAAiB,UAAChB,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AACpC,MAAG;AACF,QAAMC,KAAK,GAAGH,GAAG,CAACI,OAAJ,CAAYC,aAAZ,CAA0BC,KAA1B,CAAgC,GAAhC,EAAqC,CAArC,CAAd;;AACA,QAAMC,YAAY,GAAGC,yBAAIC,MAAJ,CAAWN,KAAX,EAAkB,+DAAlB,CAArB;;AAFE,QAGMO,MAHN,GAG0BH,YAH1B,CAGMG,MAHN;AAAA,QAGcO,OAHd,GAG0BV,YAH1B,CAGcU,OAHd;;AAIF,QAAI;AACH,UAAIjB,GAAG,CAACW,IAAJ,CAASD,MAAT,IAAmBV,GAAG,CAACW,IAAJ,CAASD,MAAT,KAAoBA,MAA3C,EACA;AACC,cAAM,iBAAN;AACA;;AACD,UAAIO,OAAO,KAAK,IAAhB,EACA;AACC,cAAM,iCAAN;AACA,OAHD,MAKA;AACCf,QAAAA,IAAI;AACJ;AACD,KAbD,CAcA,OAAMU,CAAN,EAAS;AACRX,MAAAA,GAAG,CAACY,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AACpBC,QAAAA,KAAK,EAAEH;AADa,OAArB;AAGA;AACD,GAvBD,CAwBA,OAAMA,CAAN,EAAS;AACRM,IAAAA,OAAO,CAACC,GAAR,CAAYP,CAAZ;AACAX,IAAAA,GAAG,CAACY,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AACpBC,MAAAA,KAAK,EAAE;AADa,KAArB;AAGA;AACD,CA/BD;;eAiCejB,I","sourcesContent":["import jwt from \"jsonwebtoken\"\n\nconst auth = {}\n\nauth.allUsers = (req, res, next) => {\n\ttry{\n\t\tconst token = req.headers.authorization.split(\" \")[1]\n\t\tconst decodedToken = jwt.verify(token, \"$hdsJmzjQ7,E.m2y$12$1iTvLIHS60iMROUjADnu8tdiUguselTrWjDo6SxVf\")\n\t\ttry{\n\t\t\tconst { userId } = decodedToken\n\t\t\tif( req.body.userId && req.body.userId !== userId )\n\t\t\t{\n\t\t\t\tthrow \"Invalid user ID\"\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tnext()\n\t\t\t}\n\t\t}\n\t\tcatch(e) {\n\t\t\tres.status(401).json({\n\t\t\t\terror: e\n\t\t\t})\n\t\t}\n\t}\n\tcatch(e) {\n\t\tres.status(401).json({\n\t\t\terror: \"Unauthorized request\" + e\n\t\t})\n\t}\n}\n\nauth.adminOnly = (req, res, next) => {\n\ttry{\n\t\tconst token = req.headers.authorization.split(\" \")[1]\n\t\tconst decodedToken = jwt.verify(token, \"$hdsJmzjQ7,E.m2y$12$1iTvLIHS60iMROUjADnu8tdiUguselTrWjDo6SxVf\")\n\t\tconst { userId, isAdmin } = decodedToken\n\t\ttry {\n\t\t\tif( req.body.userId && req.body.userId !== userId )\n\t\t\t{\n\t\t\t\tthrow \"Invalid user ID\"\n\t\t\t}\n\t\t\tif( isAdmin !== true )\n\t\t\t{\n\t\t\t\tthrow \"Elevated access rights required\"\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tnext()\n\t\t\t}\n\t\t}\n\t\tcatch(e) {\n\t\t\tres.status(401).json({\n\t\t\t\terror: e\n\t\t\t})\n\t\t}\n\t}\n\tcatch(e) {\n\t\tconsole.log(e)\n\t\tres.status(401).json({\n\t\t\terror: \"Unauthorized request\"\n\t\t})\n\t}\n}\n\nexport default auth"],"file":"auth.js"}