{"version":3,"sources":["../../../../src/test/api/create-user.js"],"names":["chai","use","chatHttp","expect","describe","adminSecrets","before","done","request","app","post","set","send","email","password","end","error","response","data","body","token","userId","firstName","lastName","address","gender","jobRole","department","isAdmin","status","statusCode","it","to","equal","eql","be","an","userSecrets"],"mappings":"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","sourcesContent":["import chai from 'chai'\nimport chatHttp from 'chai-http'\nimport 'chai/register-should'\nimport app from '../../app'\n\nchai.use(chatHttp);\nconst { expect } = chai;\n\ndescribe(\"create user\", () => {\n\n\tdescribe(\"admin create employee\", () => {\n\n\t\tconst adminSecrets = {}\n\t\tbefore((done) => {\n\t\t\tchai.request(app)\n\t\t\t.post('/api/v1/auth/signin')\n\t\t\t.set('Accept', 'application/json')\n\t\t\t.send({\n\t\t\t\temail: \"lovelace@gmail.com\",\n\t\t\t\tpassword: \"password\"\n\t\t\t})\n\t\t\t.end((error, response) => {\n\t\t\t\tadminSecrets.data = response.body.data\n\t\t\t\tdone();\n\t\t\t});\n\t\t})\n\n\t\tdescribe(\"input existing email\", () => {\n\t\t\tconst data = {}\n\t\t\tbefore((done) => {\n\t\t\t\tchai.request(app)\n\t\t\t\t.post('/api/v1/auth/create-user')\n\t\t\t\t.set({\n\t\t\t\t\t'Accept': 'application/json',\n\t\t\t\t\t\"Authorization\": `token: ${adminSecrets.data.token}`\n\t\t\t\t})\n\t\t\t\t.send({\n\t\t\t\t\tuserId: adminSecrets.data.userId,\n\t\t\t\t\tfirstName: \"akins\",\n\t\t\t\t\tlastName: \"akin\",\n\t\t\t\t\temail: \"turan@gmail.com\",\n\t\t\t\t\taddress: \"akins street\", \n\t\t\t\t\tpassword: \"dfjdskjfsk\",\n\t\t\t\t\tgender: \"male\",\n\t\t\t\t\tjobRole: \"Engineer\",\n\t\t\t\t\tdepartment: \"IT\",\n\t\t\t\t\tisAdmin: true\n\t\t\t\t})\n\t\t\t\t.end((error, response) => {\n\t\t\t\t\tdata.status = response.statusCode\n\t\t\t\t\tdata.body = response.body\n\t\t\t\t\tdone();\n\t\t\t\t});\n\t\t\t})\n\n\t\t\tit(\"should return 402 status code\", () => {\n\t\t\t\texpect(data.status).to.equal(402)\n\t\t\t})\n\t\t\tit(\"should return relevant error message\", () => {\n\t\t\t\texpect(data.body.error).eql(\"this email already exists\")\n\t\t\t})\n\t\t})\n\n\t\tdescribe(\"empty field(s)/ wrong input format\", () => {\n\t\t\tconst data = {}\n\t\t\tbefore((done) => {\n\t\t\t\tchai.request(app)\n\t\t\t\t.post('/api/v1/auth/create-user')\n\t\t\t\t.set({\n\t\t\t\t\t'Accept': 'application/json',\n\t\t\t\t\t\"Authorization\": `token: ${adminSecrets.data.token}`\n\t\t\t\t})\n\t\t\t\t.send({\n\t\t\t\t\tuserId: adminSecrets.data.userId,\n\t\t\t\t\tfirstName: \"\",\n\t\t\t\t\tlastName: \"\",\n\t\t\t\t\temail: \"\",\n\t\t\t\t\taddress: \"\", \n\t\t\t\t\tpassword: \"\",\n\t\t\t\t\tgender: \"\",\n\t\t\t\t\tjobRole: \"\",\n\t\t\t\t\tdepartment: \"\",\n\t\t\t\t\tisAdmin: false\n\t\t\t\t})\n\t\t\t\t.end((error, response) => {\n\t\t\t\t\tdata.status = response.statusCode\n\t\t\t\t\tdata.body = response.body\n\t\t\t\t\tdone();\n\t\t\t\t});\n\t\t\t})\n\n\t\t\tit(\"should return 422 status code\", () => {\n\t\t\t\texpect(data.status).to.equal(422)\n\t\t\t})\n\t\t\tit(\"should return an error array\", () => {\n\t\t\t\texpect(data.body.error).to.be.an('array')\n\t\t\t})\n\t\t})\n\t})\n\n\tdescribe(\"user create employee\", () => {\n\t\tconst userSecrets = {}\t\n\n\t\tbefore((done) => {\n\t\t\tchai.request(app)\n\t\t\t.post('/api/v1/auth/signin')\n\t\t\t.set('Accept', 'application/json')\n\t\t\t.send({\n\t\t\t\temail: \"turan@gmail.com\",\n\t\t\t\tpassword: \"password\"\n\t\t\t})\n\t\t\t.end((error, response) => {\n\t\t\t\tuserSecrets.data = response.body.data\n\t\t\t\tdone();\n\t\t\t});\n\t\t})\n\n\t\tdescribe(\"user not an admin\", () => {\n\t\t\tconst data = {}\n\t\t\tbefore((done) => {\n\t\t\t\tchai.request(app)\n\t\t\t\t.post('/api/v1/auth/create-user')\n\t\t\t\t.set({\n\t\t\t\t\t'Accept': 'application/json',\n\t\t\t\t\t\"Authorization\": `token: ${userSecrets.data.token}`\n\t\t\t\t})\n\t\t\t\t.send({\n\t\t\t\t\tuserId: userSecrets.data.userId,\n\t\t\t\t\tfirstName: \"sola\",\n\t\t\t\t\tlastName: \"akin\",\n\t\t\t\t\temail: \"akins@gmail.com\",\n\t\t\t\t\taddress: \"akins street\", \n\t\t\t\t\tpassword: \"dfjdskjfsk\",\n\t\t\t\t\tgender: \"male\",\n\t\t\t\t\tjobRole: \"Engineer\",\n\t\t\t\t\tdepartment: \"IT\",\n\t\t\t\t\tisAdmin: false,\n\t\t\t\t})\n\t\t\t\t.end((error, response) => {\n\t\t\t\t\tdata.status = response.statusCode\n\t\t\t\t\tdata.body = response.body\n\t\t\t\t\tdone();\n\t\t\t\t});\n\t\t\t})\n\n\t\t\tit(\"should return 401 status code\", () => {\n\t\t\t\texpect(data.status).to.equal(401)\n\t\t\t})\n\t\t\tit(\"should return error relevant message\", () => {\n\t\t\t\texpect(data.body.error).eql(\"Elevated access rights required\")\n\t\t\t})\n\t\t})\n\t})\t\n})\n"],"file":"create-user.js"}